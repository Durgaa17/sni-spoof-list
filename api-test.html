<!DOCTYPE html>
<html>
<head>
    <title>API Test - Fixed</title>
</head>
<body>
    <h1>Fixed Check-Host API Test</h1>
    <button onclick="testFixedAPI()">Test Fixed API</button>
    <div id="results"></div>

    <script type="module">
        import { testAPI } from './shared/external/check-host-api.js';
        
        async function testFixedAPI() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Testing fixed API implementation...</p>';
            
            try {
                const apiTest = await testAPI();
                
                if (apiTest.apiWorking) {
                    results.innerHTML += '<p style="color: green;">✅ API is WORKING!</p>';
                    results.innerHTML += `<p>Ping: ${apiTest.ping.success ? '✅' : '❌'}</p>`;
                    results.innerHTML += `<p>TCP: ${apiTest.tcp.success ? '✅' : '❌'}</p>`;
                    
                    if (apiTest.ping.success) {
                        results.innerHTML += `<p>Ping Success Rate: ${apiTest.ping.summary.successRate}%</p>`;
                    }
                    if (apiTest.tcp.success) {
                        results.innerHTML += `<p>TCP Success Rate: ${apiTest.tcp.summary.successRate}%</p>`;
                    }
                } else {
                    results.innerHTML += '<p style="color: red;">❌ API is NOT working</p>';
                    results.innerHTML += `<p>Error: ${apiTest.error}</p>`;
                }
            } catch (error) {
                results.innerHTML += `<p style="color: red;">❌ Test failed: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
